using System;
using System.Collections.Generic;
using System.Text;
using System.Data;
using SqlSrv = Microsoft.ApplicationBlocks.Data;

namespace Deffinity.DAL
{
	/// <summary>
	/// Table RFI_ScoreCardItems
	/// 
	/// Generated by matricrix's C# Layer Builder
	/// 23/06/2009 17:12:21
	/// 
	/// Remark: Use this class to write custom code.
	/// </summary>
    public class RFI_ScoreCardItems_DAL : RFI_ScoreCardItems_Base_DAL
    {
        /// <summary>
        /// Constructor
        /// </summary>
        private RFI_ScoreCardItems_DAL() { }

        public static DataTable Fill(int ProjectReference, int SubsectionID, string spName)
        {
            DataSet dsRFI_Questionnaire = SqlSrv.SqlHelper.ExecuteDataset(Connection.ConnectionString, CommandType.StoredProcedure, spName, new System.Data.SqlClient.SqlParameter[] { new System.Data.SqlClient.SqlParameter("@PROJECTREFERENCE", ProjectReference), new System.Data.SqlClient.SqlParameter("@SUBSECTIONID", SubsectionID) });
            return dsRFI_Questionnaire.Tables[0];
        }

        public static int Insert(int TemplateID, int ProjectReference, int SubsectionID)
        {
            return SqlSrv.SqlHelper.ExecuteNonQuery(Connection.ConnectionString, CommandType.StoredProcedure, "dbo.DEFFINITY_RFI_SCORING_TEMPLATE_INSERT", new System.Data.SqlClient.SqlParameter[] { new System.Data.SqlClient.SqlParameter("@TEMPLATEID", TemplateID), new System.Data.SqlClient.SqlParameter("@PROJECTREFERENCE", ProjectReference), new System.Data.SqlClient.SqlParameter("@SUBSECTIONID", SubsectionID) });

        }
        public static DataTable FillScoreCards(int ProjectReference, int SubsectionID, int PanelistID, string spName)
        {
            DataSet dsRFI_Questionnaire = SqlSrv.SqlHelper.ExecuteDataset(Connection.ConnectionString, CommandType.StoredProcedure, spName, new System.Data.SqlClient.SqlParameter[] { new System.Data.SqlClient.SqlParameter("@PROJECTREFERENCE", ProjectReference), new System.Data.SqlClient.SqlParameter("@SUBSECTIONID", SubsectionID), new System.Data.SqlClient.SqlParameter("@PANELISTID", PanelistID) });
            return dsRFI_Questionnaire.Tables[0];
        }

    }
}
